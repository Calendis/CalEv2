To be honest, this needs a complete rewrite! See you soon :)
